{% extends "user_dashboard.html" %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/create_invoice.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
{% endblock css %}

{% block dashboard_content %}
<div class="invoice-container">
    <header>
        <img src="{% if logo and logo.logo %}{{ logo.logo.url }}{% else %}{% static 'images/logo.jpeg' %}{% endif %}" alt="Office Logo" class="logo" onerror="this.src='{% static 'images/my.jpg' %}'">
        <h1 class="invoice-title">{{ request.user.full_name|default:"Your Office" }}</h1>
    </header>

    <h2 class="section-title text-center mb-3">सुझाव / गुनासो / प्रतिक्रिया पेटीका</h2>
    <b><h2 class="section-title text-center mb-3">(Suggestion / Feedback / Complaint Box)</h2> </b>

    <form class="form" method="POST" action="{% if feedback_uuid %}?feedback_uuid={{ feedback_uuid }}{% endif %}" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Messages -->
        {% if messages %}
        <div class="message-container">
            {% for message in messages %}
                <div class="alert alert-{% if message.tags %}{{ message.tags }}{% else %}success{% endif %}">{{ message }}</div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Rating -->
        <div class="section">
            <label class="form-label"><strong>यस कार्यालयको सेवा तपाईलाई कस्तो लाग्यो ? *(How did you like the service of this office?
)</strong></label>
            <div class="radio-group">
                {% for radio in form.rating %}
                    <div class="radio-option">
                        {{ radio.tag }}
                        <label for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
                    </div>
                {% endfor %}
            </div>
            {% if form.rating.errors %}
                <div class="alert alert-error">{{ form.rating.errors }}</div>
            {% endif %}
        </div>

        <!-- Feedback -->
        <div class="section">
            <label for="{{ form.feedback_text.id_for_label }}" class="form-label"><strong>तपाईंको सुझाव / गुनासो / प्रतिक्रिया दिनुहाेस  (Give Your Suggestion / Feedback or Complaint)
</strong></label>
            {{ form.feedback_text }}
            {% if form.feedback_text.errors %}
                <div class="alert alert-error">{{ form.feedback_text.errors }}</div>
            {% endif %}
        </div>

        <!-- File Upload -->
        <div class="section">
            <label for="{{ form.attachment.id_for_label }}" class="form-label">सम्बन्धित फोटो अथवा फाईल अपलोड गर्नुहोस (Upload related photo or file (Optional))</label>
            {{ form.attachment }}
            {% if form.attachment.errors %}
                <div class="alert alert-error">{{ form.attachment.errors }}</div>
            {% endif %}
        </div>

        <!-- Personal Info -->
        <div class="section grid-two">
            <div>
                <label for="{{ form.name.id_for_label }}" class="form-label">नाम (Name)*</label>
                {{ form.name }}
                {% if form.name.errors %}
                    <div class="alert alert-error">{{ form.name.errors }}</div>
                {% endif %}
            </div>
            <div>
                <label for="{{ form.address.id_for_label }}" class="form-label">ठेगाना (Address)*</label>
                {{ form.address }}
                {% if form.address.errors %}
                    <div class="alert alert-error">{{ form.address.errors }}</div>
                {% endif %}
            </div>
            <div>
                <label for="{{ form.mobile.id_for_label }}" class="form-label">माेबाईल (Mobile)*</label>
                {{ form.mobile }}
                {% if form.mobile.errors %}
                    <div class="alert alert-error">{{ form.mobile.errors }}</div>
                {% endif %}
            </div>
            <div>
                <label for="{{ form.email.id_for_label }}" class="form-label">ईमेल (Email)</label>
                {{ form.email }}
                {% if form.email.errors %}
                    <div class="alert alert-error">{{ form.email.errors }}</div>
                {% endif %}
            </div>
        </div>

        <!-- Anonymous Option -->
        <div class="section">
            <label class="form-label"><strong>Anonymous My Info?</strong></label>
            <div class="flex">
                {% for radio in form.anonymous %}
                    <div class="radio-option">
                        {{ radio.tag }} <label for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
                    </div>
                {% endfor %}
            </div>
            {% if form.anonymous.errors %}
                <div class="alert alert-error">{{ form.anonymous.errors }}</div>
            {% endif %}
        </div>

        <!-- Feedback Date -->
        {{ form.feedback_date }}

        <!-- Submit -->
        <div class="section text-center">
            <button type="submit" class="submit-btn">पेश गर्नुहोस (Submit)</button>
        </div>
    </form>

    <!-- Check for success message -->
    {% for message in messages %}
        {% if 'success' in message.tags %}
            <p class="note text-center">तपाईको अमुल्य सुझावको लागि धन्यबाद । सुझावको बिवरण जाच्छ गरी आवश्यक प्रकृयामा जानेछौ ।</p>
        {% endif %}
    {% endfor %}
</div>
{% endblock dashboard_content %}